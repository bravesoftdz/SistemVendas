unit U_funcoes;


interface

uses vcl.dialogs, system.sysutils;
//declara funcoes e variaveis

// criad funcao TestarPermissao, com a variavel NOME_FORM do tipo STRING
//, esperado retorno do tipo boolean
function TestarPermissao (NOME_FORM:STRING):boolean;
function EAN13 ():string;
function Ret_Numero(key: Char; Texto:string; EhDecimal:Boolean = False): Char;



implementation
//implementando as funcoes

function TestarPermissao (NOME_FORM:STRING):boolean;
    begin
       if result = True then
          begin
          ShowMessage('Acesso Negado.');
          end

     end;

    // funcao  para gerar codigo de barras ------------------------


Function EAN13() : String;
var nX, nDigito, nPeso : Integer;
var nSoma, nMaior  : Double;
var base:string;

Begin
  // aqui eu seto o valor base para gerar o digito verificador
 base  := FormatDateTime('yymmdd', Date) + FormatDateTime('hhmmss', Time);
 nPeso := 3;
 nSoma := 0;

     For nX := 12 DownTo 1 do
     Begin

     nSoma := nSoma + StrToInt( base[ nX ] ) * nPeso;

         If nPeso = 3 Then
         nPeso := 1
         Else
         nPeso := 3;

     End;

 nMaior   := ( ( Trunc( nSoma / 10 ) + 1 ) * 10 );
 nDigito  := Trunc( nMaior ) - Trunc( nSoma );

     If nDigito = 10 Then
     nDigito   := 0;
     //devolto o codigo base + o digito verificador prontos
     Result    := base + IntToStr( nDigito );

End;
// ------------fim do gera codigo de barras ----------------------


function  Ret_Numero(Key: Char; Texto: string; EhDecimal: Boolean = False): Char;
begin
  if  not EhDecimal then

    begin

      { Chr(8) = Back Space }

      if  not ( Key in ['0'..'9', Chr(8)] ) then

          Key := #0



    end

  else

    begin

      if  Key = #46 then

          Key := DecimalSeparator

      ;


      if  not ( Key in ['0'..'9', Chr(8), DecimalSeparator] ) then

          Key := #0

      else

        if  ( Key = DecimalSeparator ) and ( Pos( Key, Texto ) > 0 ) then

            Key := #0

        ;

      ;

    end

  ;


  Result := Key;

end;

end.
